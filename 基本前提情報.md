# 基本前提情報

## システム概要

### サイト名称
- 札幌山びこ山友会サイト

### サイトのURL
- https://satubiko.com


## 環境固定事項
- PHP 8.2
- SQLite
- UTF-8
- BOM禁止

## 設計原則
- 最小差分のみ
- 周辺改善禁止
- フォールバック禁止

## 重要コンポーネント
- ingest は source_state で重複防止
- trip_manage は状態遷移固定

## ルート構造（簡潔）
/v2/
 ├─ ingest/
 ├─ member/
 │   └─ trip/
 ├─ smaho/
 ├─ tool/
 └─ data/

## DB配置
data/yamabiko.db
mail/yamabiko_ml.db
member/trip/trip_manage.db

## ingestの入口と本体
run_check_*.php → check_*.php → lib_updates.php

## LINE関連
line_send.php
line_webhook.php

## 他サイトのAPI利用
ヤマレコ
youtube

## AI利用時の必須遵守事項
### 絶対ルール
バグ改修は常に 最小差分。周辺コードの「ついで改善」「最適化」は禁止。
フォールバックや冗長な堅牢化（自動判定・多段分岐など）を入れない。
既存の入出力・挙動・ログを変えない。
変更点は 差分（unified diff） で提示するか、差し替え用の全文を提示する。

